<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="/css/addPresupuesto.css">
    <title>Ingreso de Nuevo Presupuesto</title>
</head>
<body>

<div class="container">
    <h2>Ingreso de Nuevo Presupuesto</h2>

    <form id="presupuestoForm">
        
        <div class="form-group">
            <label for="numero">Número de Presupuesto:</label>
            <input type="text" id="numero" name="numero" required>
        </div>

        <div class="form-group">
            <label for="fechaEmision">Fecha de Emisión:</label>
            <input type="date" id="fechaEmision" name="fechaEmision" required>
        </div>
        
        <div class="form-group">
                <label for="cliente">Cliente:</label>
                <input type="text" id="cliente" name="cliente" list="lista-clientes" placeholder="Busca un cliente..." required autocomplete="off">
                <input type="hidden" id="cliente_id" name="cliente_id">
                <datalist id="lista-clientes"></datalist>
            </div>
            <div class="form-group">
                <label for="proyecto">Proyecto:</label>
                <input type="text" id="proyecto" name="proyecto" list="lista-proyectos" placeholder="Busca un proyecto..." required autocomplete="off">
                <input type="hidden" id="proyecto_id" name="proyecto_id">
                <datalist id="lista-proyectos"></datalist>
            </div>

        <fieldset class="form-group" style="border: none; padding: 0; margin-bottom: 0;">
            <legend style="font-weight: 600; color: #2c3e50; margin-bottom: 15px;">Detalles / Líneas de Factura</legend>
            <div id="detallesContainer">
                <div class="detalle-item" data-index="1">
                    <div class="form-group">
                        <label for="trabajo">Trabajo:</label>
                        <input type="text" id="trabajo" name="detalle-trabajo">
                    </div>
                    <div class="form-group">
                        <label for="descripcion">Descripción de Detalle:</label>
                        <input type="text" id="descripcion" name="detalle-descripcion">
                    </div>
                    <div class="form-group fila-calculos">
                        <div class="columna-dato">
                            <label for="cantidad">Cantidad:</label>
                            <input type="text" id="cantidad" name="detalle-cantidad" min="1" oninput="this.value = this.value.replace(/[^0-9.,]/g, '')">
                        </div>
                        <div class="columna-dato">
                            <label for="precioUnitario">Precio Unitario:</label>
                            <input type="text" id="precioUnitario" name="detalle-precioUnitario" step="0.01" oninput="this.value = this.value.replace(/[^0-9.,]/g, '')">
                        </div>
                        <div class="columna-dato" style="margin-bottom: 0;">
                            <label for="subtotal-1">Subtotal:</label>
                            <input type="number" id="subtotal-1" name="detalle-subtotal" step="0.01" readonly>
                        </div>
                    </div>
            </div>
        </fieldset>
        
        <button type="button" class="btn-secondary" id="btnAddDetail">Añadir Detalle</button>

        <div class="form-group">
            <label>Tipo de IVA:</label>
            <div class="radio-group">
                <label for="iva_21">
                    <input type="radio" id="iva_21" name="tipo_iva" value="21" checked> 21%
                </label>
                <label for="iva_10">
                    <input type="radio" id="iva_10" name="tipo_iva" value="10"> 10%
                </label>
            </div>
        </div>
        <div class="form-group">
            <label for="total_bruto">Total Bruto Presupuesto:</label>
            <input type="text" id="total_bruto" name="total" step="0.01" readonly>
        </div>
        <div class="form-actions">
            <button type="submit" class="btn-submit">Guardar Factura</button>
            <button type="button" class="btn-volver" onclick="volverAlIndex()">Volver al Index</button>
        </div>
    </form>

    <div id="message"></div>
</div>
<script src="/js/addPresupuesto.js"></script>
</body>
</html>